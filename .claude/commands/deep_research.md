---
description: 深度研究模式，专注于代码库理解和架构分析的功能开发
argument-hint: 可选的功能描述
---

# 功能开发
你正在帮助开发者实现一个调研一个功能。
请遵循系统化的方法：深入理解代码库、调研相关文档、识别并询问所有未详细说明的细节、设计优雅的架构，然后实施。

## 核心原则

- **提出澄清问题**：识别所有歧义、边界情况和未详细说明的行为。提出具体、明确的问题，而不是自行假设。在继续实施之前等待用户回答。尽早提问（在理解代码库之后、设计架构之前）。
- **先理解后行动**：首先阅读并理解现有的模式
- **阅读 Agent 识别的文件**：当启动 Agent 时，要求它们返回需要阅读的最重要文件列表。Agent 完成后，阅读这些文件以在继续之前构建详细的上下文。
- **使用 TodoWrite**：全程跟踪所有进度

---

## 阶段 1：发现

**目标**：理解需要调研什么

初始请求：$ARGUMENTS

**行动**：
1. 创建包含所有阶段的待办事项列表
2. 如果调研不明确，向用户询问：
   - 他们要调研什么问题？
   - 调研应该做什么？
   - 是否有任何约束或要求？
3. 总结理解并请用户确认

---


## 阶段 3：调研探索

**目标**：按照要求调研

**行动**：
1. 如果你需要从多方面去调研，应该并行多个 agent
2. 从调研的结果分析，如果发现新的方向，则继续启动 agent 去调研。直到没有新的调研内容了

---


## 阶段 4：代码库探索

**目标**：在高层和低层理解相关的现有代码和模式

**行动**：
1. 并行启动 2-3 个 code-explorer Agent。每个 Agent 应该：
   - 全面地跟踪代码，专注于获得对抽象、架构和控制流的全面理解
   - 针对代码库的不同方面（例如：类似功能、高层理解、架构理解、用户体验等）
   - 包含 5-10 个需要阅读的关键文件列表

   **Agent 提示示例**：
   - "查找与 [功能] 类似的功能并全面跟踪其实现"
   - "映射 [功能领域] 的架构和抽象，全面跟踪代码"
   - "分析 [现有功能/领域] 的当前实现，全面跟踪代码"
   - "识别与 [功能] 相关的 UI 模式、测试方法或扩展点"

2. Agent 返回后，阅读 Agent 识别的所有文件以建立深入理解
3. 展示发现和模式的综合总结

---

## 阶段 5：澄清问题

**目标**：在设计之前填补空白并解决所有歧义

**关键**：这是最重要的阶段之一。不要跳过。

**行动**：
1. 结合调研的结果， 和代码库现有的模式
3. **以清晰、有组织的列表向用户展示所有问题**

## 阶段 6：总结

**目标**：记录完成的工作

**行动**：
1. 将所有待办事项标记为完成
2. 总结：
   - 你的发现
   - 都有什么方案
   - 建议的后续步骤
3. 询问用户下一步做什么
